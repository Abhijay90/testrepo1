<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="images/favicon.ico" type="image/ico" />
    <meta name="theme-color" content="#4E00FF" />

    <title>BENCHMARK METRICS</title>

    <!-- Bootstrap -->
    <link href="../static/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../static/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../static/vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="../static/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
  
    <!-- bootstrap-progressbar -->
    <link href="../static/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <!-- JQVMap -->
    <link href="../static/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet"/>
    <!-- bootstrap-daterangepicker -->
    <link href="../static/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="../static/build/css/custom.min.css" rel="stylesheet">

    <!-- New Styles -->
    <link href="../static/build/css/ncreato.css" rel="stylesheet">

  </head>

  <body>
    <div class="container main">
        <section class="top_prof">
          <div class=" prime">
              <div class="valign" style="height:100%">
                <div class="row" style="height:100%">
                  <div  style="height:100%">
                    <div class="pp_out">
                      <div class="pp">
                        <img src="../static/build/images/dummy-profile.jpg" alt="Profile Name" />
                      </div>
                      <!-- <div  class="ratio img-responsive img-circle" style="background-image: url('../static/build/images/dummy-profile.jpg');"></div> -->
                    </div>
                    <div class="pdet_out">
                      <div class="pdet valign">
                        <h3>Alex Pandiyan</h3>
                        <h6>CHRO</h6>
                        <h6><span>TATA CONSULTANCY SERVICES</span></h6>
                      </div>
                    </div>
                    <div class="clear"></div>
                  </div>
                </div>
              </div>
          </div>
        </section>
        <section class="middle_scroll">
          <div class="row scroll" style="height:100%">
            <div class="col-md-12 col-xs-12" style="height:100%">
              <div id="myCarousel" class="carousel slide desktop" data-ride="carousel" data-type="multi" data-interval="2500" style="height:60%">
                <!-- Indicators -->
                <ol class="carousel-indicators" style="display:none">
                  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#myCarousel" data-slide-to="1"></li>
                  <li data-target="#myCarousel" data-slide-to="2"></li>
                  <li data-target="#myCarousel" data-slide-to="3"></li>
                </ol>

                <!-- Wrapper for slides -->
                <div class="carousel-inner" role="listbox">


                  <div class="item active" id="data">

                    <div class="item-head">
                      <div ><h3 id="title"> </h3></div>
                      <div class="btns">
                        <button  class ="active" onclick="change_tab('tier');$('.btns button').removeClass('active'); $(this).addClass('active');" id="def_click">TIER</button>
                        <button onClick="change_tab('industry');$('.btns button').removeClass('active'); $(this).addClass('active');">INDUSTRY</button>
                        <button onClick="change_tab('peers') ;$('.btns button').removeClass('active'); $(this).addClass('active');">PEERS(&#x20B9;)</button>
                      </div>
                      <h6 class="item_hd">{{resp["head"]}}</h6>
                    </div>
                    <div class="chart_hold">
                      <div class="chart_view bar ">
                      
                      <div id="graph" class="showhide gp"></div>
                      
                      </div>

                      
                      <div class="chart_view table valign">
                        <!-- tier data-->
                        <div id="data-table" >
                          <ul class="tb thead">
                            <li>Segment</li><li>Data</li>
                          </ul>

                          <div id="table_body">

                          </div>


                        </div>
                        <!-- tier data-->
                      </div>
                      <table style="display:none" id = "graph-table">
                         <thead>
                            <tr>
                                <th></th>
                                <th>Segments</th>
                                </tr>
                              </thead>
                            <tbody id = "table_body_graph">                              
                            </tbody>
                      </table>




                    </div>
                  </div>


                  <div class="item active" id="data2">

                    <div class="item-head">
                      <div ><h3 id="title"> </h3></div>
                      <div class="btns">
                        <button  class ="active" onclick="change_tab('tier');$('.btns button').removeClass('active'); $(this).addClass('active');" id="def_click">TIER</button>
                        <button onClick="change_tab('industry');$('.btns button').removeClass('active'); $(this).addClass('active');">INDUSTRY</button>
                        <button onClick="change_tab('peers') ;$('.btns button').removeClass('active'); $(this).addClass('active');">PEERS(&#x20B9;)</button>
                      </div>
                      <h6 class="item_hd">{{resp["head"]}}</h6>
                    </div>
                    <div class="chart_hold">
                      <div class="chart_view bar ">
                      
                      <div id="graph" class="showhide gp"></div>
                      
                      </div>

                      
                      <div class="chart_view table valign">
                        <!-- tier data-->
                        <div id="data-table" >
                          <ul class="tb thead">
                            <li>Segment</li><li>Data</li>
                          </ul>

                          <div id="table_body">

                          </div>


                        </div>
                        <!-- tier data-->
                      </div>
                      <table style="display:none" id = "graph-table">
                         <thead>
                            <tr>
                                <th></th>
                                <th>Segments</th>
                                </tr>
                              </thead>
                            <tbody id = "table_body_graph">                              
                            </tbody>
                      </table>




                    </div>
                  </div>

                </div>

                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel"  onclick="go_prev_link();" role="button" data-slide="prev">
                  <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel"  onclick="go_next_link()" role="button" data-slide="next">
                  <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                  <span class="sr-only" >Next</span>
                </a>
              </div>
              <div id="myCarousel" class="carousel slide mobile" data-ride="carousel" data-type="multi" data-interval="2500" style="height:60%">
                <!-- Indicators -->
                <ol class="carousel-indicators" style="display:none">
                  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#myCarousel" data-slide-to="1"></li>
                  <li data-target="#myCarousel" data-slide-to="2"></li>
                  <li data-target="#myCarousel" data-slide-to="3"></li>
                </ol>

                <!-- Wrapper for slides -->
                <div class="carousel-inner" role="listbox">


                  <div class="item active" id="data3">

                    <div class="item-head">
                      <div ><h3 id="title"> </h3></div>
                      <div class="btns">
                        <button  class ="active" onclick="change_tab('tier');$('.btns button').removeClass('active'); $(this).addClass('active');" id="def_click">TIER</button>
                        <button onClick="change_tab('industry');$('.btns button').removeClass('active'); $(this).addClass('active');">INDUSTRY</button>
                        <button onClick="change_tab('peers') ;$('.btns button').removeClass('active'); $(this).addClass('active');">PEERS(&#x20B9;)</button>
                      </div>
                      <h6 class="item_hd">{{resp["head"]}}</h6>
                    </div>
                    <div class="chart_hold">
                      <div class="chart_view bar ">
                      
                      <div id="graph" class="showhide gp"></div>
                      
                      </div>

                      
                      <div class="chart_view table valign">
                        <!-- tier data-->
                        <div id="data-table" >
                          <ul class="tb thead">
                            <li>Segment</li><li>Data</li>
                          </ul>

                          <div id="table_body">

                          </div>


                        </div>
                        <!-- tier data-->
                      </div>
                      <table style="display:none" id = "graph-table">
                         <thead>
                            <tr>
                                <th></th>
                                <th>Segments</th>
                                </tr>
                              </thead>
                            <tbody id = "table_body_graph">                              
                            </tbody>
                      </table>




                    </div>
                  </div>

                </div>

                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel"  onclick="go_prev_link();" role="button" data-slide="prev">
                  <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel"  onclick="go_next_link()" role="button" data-slide="next">
                  <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                  <span class="sr-only" >Next</span>
                </a>
              </div>
              <div class="carousel-tabs">
                <ul>
                  <li id="bar"><img src="../static/build/images/icon4.png" /></li>
                  <li id="table"><img src="../static/build/images/icon6.png" /></li>
                </ul>
              </div>
              <div class="carousel-bottom">
                <div class="btns">
                  <button>EXPORT</button>
                  <button>SHARE</button>
                </div>
                <img src="../static/build/images/latest.jpg" />
              </div>
            </div>
          </div>
        </section>
        <section class="bottom_tabs">
          <ul class="valign">
            <li>
              <a href="/home"><span><i class="fa fa-lg fa-home"></i><br/>HOME</span></a>
            </li>
          </ul>
        </section>
    </div>
  </body>


    <!-- jQuery -->
    <script src="../static/vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../static/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <!-- <script src="../static/vendors/fastclick/lib/fastclick.js"></script> -->
    <!-- NProgress -->
    <!-- <script src="../static/vendors/nprogress/nprogress.js"></script> -->
    <!-- Chart.js -->
    <script src="../static/vendors/Chart.js/dist/Chart.min.js"></script>
    <!-- gauge.js -->
    <!-- <script src="../static/vendors/gauge.js/dist/gauge.min.js"></script> -->
    <!-- bootstrap-progressbar -->
    <!-- <script src="../static/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script> -->
    <!-- iCheck -->
    <!-- <script src="../static/vendors/iCheck/icheck.min.js"></script> -->
    <!-- Skycons -->
    <!-- <script src="../static/vendors/skycons/skycons.js"></script> -->
    <!-- Flot -->
    <!-- <script src="../static/vendors/Flot/jquery.flot.js"></script>
    <script src="../static/vendors/Flot/jquery.flot.pie.js"></script>
    <script src="../static/vendors/Flot/jquery.flot.time.js"></script>
    <script src="../static/vendors/Flot/jquery.flot.stack.js"></script>
    <script src="../static/vendors/Flot/jquery.flot.resize.js"></script> -->
    <!-- Flot plugins -->
    <!-- <script src="../static/vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
    <script src="../static/vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
    <script src="../static/vendors/flot.curvedlines/curvedLines.js"></script> -->
    <!-- DateJS -->
    <!-- <script src="../static/vendors/DateJS/build/date.js"></script> -->
    <!-- JQVMap -->
    <!-- <script src="../static/vendors/jqvmap/dist/jquery.vmap.js"></script>
    <script src="../static/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
    <script src="../static/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script> -->
    <!-- bootstrap-daterangepicker -->
    <!-- <script src="../static/vendors/moment/min/moment.min.js"></script>
    <script src="../static/vendors/bootstrap-daterangepicker/daterangepicker.js"></script> -->



    <script src="../static/vendors/raphael/raphael.min.js"></script>
    <script src="../static/vendors/morris.js/morris.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
  
  <script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/data.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>




        <!-- Custom Theme Scripts -->
    <!-- <script src="../build/js/custom.min.js"></script> -->

    <!-- <script src="../static/build/js/custom_example.js"></script> -->
  <script>
   $('.carousel').carousel({
      interval: false
  });

    $("#bar").click(function(){
      $(".carousel-inner").removeClass("table");
    });

    $("#table").click(function(){
      $(".carousel-inner").addClass("table");
    });
</script>




<script type="text/javascript">

last_val="";

  function show_hide_tables(val){
    if (val!=last_val){
      console.log(val);
      $(".showhide").fadeOut(300);
      $("#"+val).fadeIn(300);
      last_val=val;
    }
  }

 var json_string = {{resp|tojson}};




  var url_redirect_objects=
["/metrics/",
"/metrics/revenue_employee",
"/metrics/employee_cost_to_revenue",
"/metrics/employee_cost_avg",
"/metrics/attrition_voluntary",
"/metrics/attrition_all",
"/metrics/hiring_quarterly",
"/metrics/hiring_annual",
"/metrics/hiring_cost",
"/metrics/time_to_hire",
"/metrics/headcount_hr"
];

 var recieved_arr=$.parseJSON($.cookie("nxt_arr"));
  // var recieved_arr=[1,2,4];

  current_url = window.location.pathname;
  pg_val = url_redirect_objects.indexOf(current_url);

  function go_next_link(){

    init_change(1);
    return 0;


    if (recieved_arr.length==1){
      return 0;
    }
    // url_redirect_objects.indexOf(pg_val);
    index=recieved_arr.indexOf(pg_val)
    if (index==recieved_arr.length-1){
      index=0;
    }
    else{
      index=index+1
    }
    window.location.href=url_redirect_objects[recieved_arr[index]];
  }

function go_prev_link(){
      init_change(-1);
    return 0;

    if (recieved_arr.length==1){
      return 0;
    }

    // url_redirect_objects.indexOf(pg_val);
    index=recieved_arr.indexOf(pg_val)
    if (index==0){
      index=recieved_arr.length-1;
    }
    else{
      index=index-1
    }
    window.location.href=url_redirect_objects[recieved_arr[index]];

  }


function create_table_elements(value){

  function create_table_row(val,val2){
    $("#table_body").append(val).fadeIn(500);
    $("#table_body_graph").append(val2);

  }


  obj_table_map = {"tier":json_string[json_index].data.tier,"peers":json_string[json_index].data.peers,"industry":json_string[json_index].data.industry};

  // console.log(obj_table_map[value]);
  graph_provider(obj_table_map[value])

  $.each(obj_table_map[value],function(i,e){
   if (e!=-1 && i=="user_data"){
     row_element ='<ul class="tb tbody"> <li>You </li><li>'+e+'</li></ul>';
     t_g = '<tr><td>You</td><td>'+e+'</td></tr>'
     create_table_row(row_element,t_g);
   } 

   if (e!=-1 && i=="data"){
     row_element ='<ul class="tb tbody"><li> Everyone Else </li><li>'+e+'</li></ul>';
     t_g = '<tr><td>Everyone Else </td><td>'+e+'</td></tr>'
     create_table_row(row_element,t_g);
   } 


   if ( i=="tab_data"){
    if (e.length>0 )
    {   
    $.each(e,function(inc,el)
    {
       row_element ='<ul class="tb tbody"><li>'+el.name+'</li><li>'+el.data+'</li></ul>';
       t_g = '<tr><td>'+el.name+' </td><td>'+el.data+'</td></tr>'
       create_table_row(row_element,t_g);
    });
     
   } 

   }

// graph_provider();
   
  });

  // 
}

function destroy_table_elements(value)
{

$("#table_body").fadeOut(50).empty();//,function(){$(this).empty()});
  // $("#table_body").empty();
$("#table_body_graph").empty();

}

function change_title(value)
{

$("#title").text(value);

}

function change_tab(value){

destroy_table_elements(value);
create_table_elements(value);

}

var json_index=0;

function init_change(val1){

  if (json_string.length==1 && val1 !=0){
    return 0
  }

  if (val1==1){
    if (json_index==json_string.length-1){
      json_index=0;
    }
    else{
     json_index=json_index+1; 
    }
  }

  if (val1==-1){
    if (json_index==0){
      json_index=json_string.length-1;
    }
    else{
     json_index=json_index-1; 
    }
  }


  change_title(json_string[json_index].data.head);

  destroy_table_elements();
  $("#def_click").click();

  // create_table_elements("tier");

}



var graph_provider_bkp = function () {
    var options = {
        data: {
            table: document.getElementById('graph-table'),
            switchRowsAndColumns: true
        },
        chart: {
            type: 'column'
        },
        yAxis: {
            allowDecimals: false,
            title: {
                text: null,
            }
        },
        title:{
          text:null,

        },

        xAxis: {
          title: {
            text:null,
            // labels: null,
          },
          labels:{
            enabled:false,
          }
        },
        credits: {
          enabled:false,
        }
    };

    $('#graph').highcharts(Highcharts.merge(options));
    $('#toggle').click(function () {
        options.data.switchRowsAndColumns = !options.data.switchRowsAndColumns;
        $('#graph').highcharts(Highcharts.merge(options));
    });
};


function data_graph(value){
  var resp_val = []
  $.each(value,function(i,v){
  if(i!=="drill_down"){
    if(v.constructor === Array){
      $.each(v,function(ind,val){
      resp_val.push({"name":val["name"],"y":parseFloat(val["data"])});
      });
    }
    else{
      if (v!=-1){
          resp_val.push({"name":i,"y":parseFloat(v)})
      }
    }
  }

});

if(value["drill_down"].length>0){
  $.each(resp_val,function(i,v){
    v["drilldown"]=v["name"]
  });
}

// console.log(resp_val);

return resp_val
}




function data_drilldown(value){
  console.log("in drilldown");
  var resp_val=[]
  $.each(value,function(ind,val){
    index = resp_val.map(function(el){return el.name}).indexOf(val["name"])
    console.log(index);
    if (index == -1 ){
      resp_val.push({"name":val["name"],"id":val["name"],"data":[]})
      resp_val[resp_val.length-1]["data"].push([val["sub_name"],parseFloat(val["data"])])
    }
    else{
      resp_val[index]["data"].push([val["sub_name"],parseFloat(val["data"])])
    }
  });
console.log(resp_val);
return resp_val

}

var graph_provider = function (value) {
  console.log(value);
    var options = {
        chart: {
            type: 'column'
        },
        yAxis: {
            allowDecimals: false,
            title: {
                text: null,
            }
        },
        title:{
          text:null,

        },

        xAxis: {
          title: {
            text:null,
            // labels: null,
          },
          labels:{
            enabled:false,
          }
        },
        credits: {
          enabled:false,
        },
        series:[{
          name:"",
          data: data_graph(value),
        }],
        drilldown:{
          "series":data_drilldown(value["drill_down"]),
        }
    };

    $('#graph').highcharts(Highcharts.merge(options));
    $('#toggle').click(function () {
        options.data.switchRowsAndColumns = !options.data.switchRowsAndColumns;
        $('#graph').highcharts(Highcharts.merge(options));
    });
};


init_change(0);

</script>

  </body>

</html>
